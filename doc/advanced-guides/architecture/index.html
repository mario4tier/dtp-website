<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="<<Work in progress. High level for now, exhaustive specs later>>"><meta name=author content="Mario Fortier"><link rel=icon href=../../../images/favicon.png><meta name=generator content="mkdocs-1.4.2, mkdocs-material-9.0.3"><title>Architecture - DTP - Decentralized Transport Protocol</title><link rel=stylesheet href=../../../assets/stylesheets/main.6b71719e.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.2505c338.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=blue data-md-color-accent=blue> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#architecture class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title="DTP - Decentralized Transport Protocol" class="md-header__button md-logo" aria-label="DTP - Decentralized Transport Protocol" data-md-component=logo> <img src=../../../assets/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> DTP - Decentralized Transport Protocol </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Architecture </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/mario4tier/dtp title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> mario4tier/dtp </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../../examples/ class=md-tabs__link> Use cases </a> </li> <li class=md-tabs__item> <a href=../../../setup/dev/ class=md-tabs__link> Getting started </a> </li> <li class=md-tabs__item> <a href=../../../ref/architecture/ class=md-tabs__link> Reference </a> </li> <li class=md-tabs__item> <a href=../../../community/ class=md-tabs__link> Community </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title="DTP - Decentralized Transport Protocol" class="md-nav__button md-logo" aria-label="DTP - Decentralized Transport Protocol" data-md-component=logo> <img src=../../../assets/logo.png alt=logo> </a> DTP - Decentralized Transport Protocol </label> <div class=md-nav__source> <a href=https://github.com/mario4tier/dtp title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> mario4tier/dtp </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 tabindex=0 aria-expanded=false> Use cases <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Use cases" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Use cases </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../examples/ class=md-nav__link> Application Examples </a> </li> <li class=md-nav__item> <a href=../../../example/web3_rust/ class=md-nav__link> Web3 Rust Server </a> </li> <li class=md-nav__item> <a href=../../../example/rpc_firewall/ class=md-nav__link> JSON-RPC Firewall </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 tabindex=0 aria-expanded=false> Getting started <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Getting started" data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Getting started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../setup/dev/ class=md-nav__link> Developers Setup </a> </li> <li class=md-nav__item> <a href=../../../faq/ class=md-nav__link> FAQ </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 tabindex=0 aria-expanded=false> Reference <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Reference data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " data-md-toggle=__nav_4_1 type=checkbox id=__nav_4_1> <label class=md-nav__link for=__nav_4_1 tabindex=0 aria-expanded=false> Architecture <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Architecture data-md-level=2> <label class=md-nav__title for=__nav_4_1> <span class="md-nav__icon md-icon"></span> Architecture </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../ref/architecture/ class=md-nav__link> Basic Concepts </a> </li> <li class=md-nav__item> <a href=../../../ref/firewall/ class=md-nav__link> Firewall </a> </li> <li class=md-nav__item> <a href=../../../ref/channels/ class=md-nav__link> Multi-Channels </a> </li> <li class=md-nav__item> <a href=../../../ref/broadcast/ class=md-nav__link> Broadcasting </a> </li> <li class=md-nav__item> <a href=../../../ref/data_life/ class=md-nav__link> Data Lifecycle </a> </li> <li class=md-nav__item> <a href=../../../ref/future_work/ class=md-nav__link> Future works </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " data-md-toggle=__nav_4_2 type=checkbox id=__nav_4_2> <label class=md-nav__link for=__nav_4_2 tabindex=0 aria-expanded=false> API <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=API data-md-level=2> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> API </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../ref/rust_api/ class=md-nav__link> Rust API </a> </li> <li class=md-nav__item> <a href=../../../ref/ts_api/ class=md-nav__link> Typescript API </a> </li> <li class=md-nav__item> <a href=../../../ref/scripts/ class=md-nav__link> DTP Scripts </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../community/ class=md-nav__link> Community </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#target-audience class=md-nav__link> Target Audience </a> </li> <li class=md-nav__item> <a href=#dtp-connection-types class=md-nav__link> DTP Connection Types </a> </li> <li class=md-nav__item> <a href=#dtp-address class=md-nav__link> DTP Address </a> </li> <li class=md-nav__item> <a href=#at-high-level-how-is-the-sui-network-used class=md-nav__link> At high level, how is the Sui Network used? </a> </li> <li class=md-nav__item> <a href=#dtp-glossary class=md-nav__link> DTP Glossary </a> </li> <li class=md-nav__item> <a href=#firewall class=md-nav__link> Firewall </a> </li> <li class=md-nav__item> <a href=#multi-channel-connection class=md-nav__link> Multi-Channel Connection </a> </li> <li class=md-nav__item> <a href=#uni-directional-connection class=md-nav__link> Uni-directional Connection </a> </li> <li class=md-nav__item> <a href=#high-availability-and-load-balancing class=md-nav__link> High-Availability and Load Balancing </a> </li> <li class=md-nav__item> <a href=#data-deletion class=md-nav__link> Data Deletion </a> </li> <li class=md-nav__item> <a href=#data-consumption-confirmation class=md-nav__link> Data Consumption Confirmation </a> </li> <li class=md-nav__item> <a href=#public-broadcasting class=md-nav__link> Public Broadcasting </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=architecture>Architecture<a class=headerlink href=#architecture title="Permanent link">&para;</a></h1> <h2 id=target-audience>Target Audience<a class=headerlink href=#target-audience title="Permanent link">&para;</a></h2> <p>Developers should first read the SDK documentations for how to use DTP.</p> <p>The architecture document is intended for developers modifying DTP itself.</p> <h2 id=dtp-connection-types>DTP Connection Types<a class=headerlink href=#dtp-connection-types title="Permanent link">&para;</a></h2> <p>At functional level, DTP is similar to TCP but differs significantly in its implementation to benefit from what is already provided by the L1 network.</p> <p>There are 3 types of data transfer:</p> <ul> <li>Bidirectional : Connection-oriented (like TCP) between two end-users. Always encrypted.</li> <li>Unidirectional: Also connection-oriented between two end-users (for encryption), but heavy data flows only in one direction.</li> <li>Public Broadcast: Anyone can receive and observe the authenticated stream of data. This is the only transfer mode without encryption. Requires a different set of object/API calls to avoid accidently broadcasting.</li> </ul> <p>DTP data is originated using Sui transactions.\ The data is received through event streams.\</p> <h2 id=dtp-address>DTP Address<a class=headerlink href=#dtp-address title="Permanent link">&para;</a></h2> <p>The typical \<ip address>:\<port> becomes a \<host sui address>:\<port>\ \ SuiNS will be evaluated for DNS.</p> <h2 id=at-high-level-how-is-the-sui-network-used>At high level, how is the Sui Network used?<a class=headerlink href=#at-high-level-how-is-the-sui-network-used title="Permanent link">&para;</a></h2> <p>Sui owned objects are used for unidirectional data transfer with sub-second latency (See <a href=https://docs.sui.io/devnet/learn/how-sui-works#simple-transactions>Simple Transaction</a> in Sui docs).</p> <p>Data Ingress: A data stream is sliced into transactions (txns) and added to the Sui network. The txns are targeted to a destination Pipe.</p> <p>Data egress: The data "exit" the network through event streams (emitted by the txns being received at the destination Pipe). The transmitted data can be "observed" by any users, but decoded only by the ones having the decryption key.\ \ The receiving end DTP SDK re-assembles the txns into the original data stream. The stream is then forwarded to the intended end-user (a TCP server, a Rust application layer above etc...).\ \ Slower transactions (Sui consensus) are used for most "control plane" synchronizations. \</p> <h2 id=dtp-glossary>DTP Glossary<a class=headerlink href=#dtp-glossary title="Permanent link">&para;</a></h2> <figure><img src=../.gitbook/assets/terminology_1.png alt><figcaption><p>Example of two connections between 3 end-users</p></figcaption></figure> <p><strong>Client</strong>: End-point initiating a bi-directional connection with a Node.</p> <p><strong>Connection:</strong> One connection allows to exchange data between two end-users. Can be uni or bi-directional. An end-user creates a connection by calling a function into the destination DTP Node object (See <a href=../dtp-built-in-services/connection-api/ >Connection API</a>).</p> <p><strong>End-Point</strong>: An off-chain process that can send/receive data. An end point can handle multiple local end users, protocols and connections simultaneously (each independently encrypted).</p> <p><strong>End-User</strong>: A signature authority that can send/receive data.</p> <p><strong>Node Object</strong>: Any end-user that want to transfer data must create its own Node object. This is a Sui shared object involved in many control plane transactions (e.g. creation of a connection). The node allows to configure the services (and SLA) that are to be provided, the lifecycle of its associated connections, the management of its end-points. Nodes also control the firewall.\ Nodes are shared Sui object.</p> <p><strong>Objects:</strong> Usually refer to on-chain Sui objects ( See <a href=https://docs.sui.io/build/programming-with-objects>Sui Docs</a> )</p> <p><strong>Pipe Object</strong>: End-points can never directly exchange data with each other directly (their IP is not known to the peer). All data plane transfers involves an intermediate object on the Sui network. One pipe is required per direction of a connection. A pipe can from time to time change the endpoint for high-availability or load balancing (if the end-user have configured multiple end-point to its Node). Pipe are owned Sui objects (owner is the sender of the data stream).\ \ <strong>Server</strong>: End-point intended to respond to client requests.\ \ <strong>Service Level Agreement (SLA)</strong>: Specify the costs, limitations and some behaviors for a service provided by a Node object. Example would be "sent data can be deleted from network storage after 48 hours (2 epochs)". The client signify that it agrees to a SLA at the time the connection to the node is initiated. The SLA specs are such that DTP can enforce the agreement in a fair way to all parties.</p> <p><strong>Transport Control Object</strong>: Variables and state machines that exists for the lifetime of a single connection. This is a Sui shared object.</p> <h2 id=firewall>Firewall<a class=headerlink href=#firewall title="Permanent link">&para;</a></h2> <p>Set of DTP built-in features protecting and enforcing fair use of the off-chain applications. \ \ Includes:</p> <ul> <li>Protect the receiver by allowing/blocking/limiting new connections depending of the sender address.</li> <li>Rate limiting on a per-connection basis. The control is mostly done from the off-chain server, but metering and some limiting is handled on-chain.&#x20;</li> <li>On long term considering also on-chain escrow services for service level agreement (SLA) between client and server.</li> <li>Protect the sender from initiating/paying for transactions while the server is already known offline or too busy (backpressure management). This could allow the sender to more quickly fallback to another server.\</li> </ul> <p>DDoS are unlikely since the burden of gas execution is mostly on the sender. Still a firewall is useful in case of financial attack on the service provider (exploitation of a request cost being low versus the cost of responding).\</p> <figure><img src=../.gitbook/assets/firewall.png alt><figcaption><p>Built-in Firewall Capabilities</p></figcaption></figure> <p>Details on the illustration:</p> <p>(1) Gas cost of processing incoming traffic is paid by the sender. That includes connection creation cost and running the firewall at the Pipe Object. Most abuse can therefore be neutralized without requiring any processing/cost from the Server.</p> <p>(2) Optionally, the DTP Node object can gather statistics from all its Pipe objects and adjust the rate limiting rules. This may happen when the Server detects excessive incoming traffic. The gas cost for these likely rare adjustments are to be handled by the Server. (Note: This is a logical representation. More details will follow on how this is implemented such that Pipe objects are not involved with slower consensus transactions).\ \ (3) The server configure the firewall and does a periodical heartbeat using its shared DTP Node object. The server may also do some fast detection and control on the firewall (TBD).\ \ (4) When a transaction has no-effect because of the firewall, there is no event emitted (and sender is inform that the transaction was executed, but blocked by the firewall). Therefore the Server is not impacted.\ \</p> <h2 id=multi-channel-connection>Multi-Channel Connection<a class=headerlink href=#multi-channel-connection title="Permanent link">&para;</a></h2> <p>Data is transmitted as a stream and therefore must be divided into smaller transactions. Even with a fast finality, the bandwidth is limited by the maximum transaction size.\ \ Multiple simple transactions executed in parallel can provide higher bandwidth for a single connection.\ \ Most of the complexity will be in the off-chain end-points when dividing and re-assembling the data stream:</p> <figure><img src=../.gitbook/assets/multi-channels.png alt><figcaption></figcaption></figure> <p><strong>Will this be practical?</strong>\ There is a lot of cost/performance unknowns with both Sui network and DTP that will probably persist through 2023. DTP architecture is planning for supporting heavy media streaming, but it remains to be seen how practical it will be.\ \ Gas might be expensive and there is some potential limitations about how much Sui fullnodes could scale on a viral broadcast (problem at egress of the network, not with the consensus performance itself).\ \ Light data streaming (&lt;20 Kbps) very likely to be supported and be useful within 2023.\ \ Regardless of practicality, support for multi-channel will be at least useful for demo/stress load on a test network.\ \ Some estimations ( See on <a href="https://docs.google.com/spreadsheets/d/1zBrB1ifhPpnLlsDr6nBN_N55Kkw9hX06a7EVUpogyn4/edit?usp=sharing">Google Sheet</a> ):</p> <figure><img src=../.gitbook/assets/multi_channel_est.PNG alt><figcaption></figcaption></figure> <p>&#x20; <mark style=color:red;>(Note: Numbers are best guess as of 11/21/22. Will be revised from time to time)</mark></p> <h2 id=uni-directional-connection>Uni-directional Connection<a class=headerlink href=#uni-directional-connection title="Permanent link">&para;</a></h2> <figure><img src=../.gitbook/assets/uni-directional.png alt><figcaption><p>Uni-Directional Connection. One direction data plane, but still bi-directional control plane.</p></figcaption></figure> <p>Pipe object are unidirectional for the data transfer (two needed for a bi-directional connection).\ \ Although the data is intended to flow in one direction, some lightweight bi-directional exchanges still happens at various point:\ \ (1) When the connection is created, some bi-directional exchange happen between the source end-point and the destination DTP Node object.\ \ (2) Exchange between end-points through the "Transport Control Object". This relates mostly to the encryption protocol and application of the Service Level Agreement.</p> <p>(3) Pipe are not <strong>purely</strong> unidirectional. Sender interactions with a Pipe are done with transactions, which means a return value for some immediate responses (e.g. the data was not sent because of a receiver firewall rule).</p> <h2 id=high-availability-and-load-balancing>High-Availability and Load Balancing<a class=headerlink href=#high-availability-and-load-balancing title="Permanent link">&para;</a></h2> <figure><img src="../.gitbook/assets/ha (1).png" alt><figcaption><p>Forwarding decision made by Pipe object when multiple end-points (servers) </p></figcaption></figure> <p>Off-chain servers can share the incoming load or be each others fallback for high-availability.</p> <p>Unlike traditional network, the data is not physically pushed toward a server. Instead, the data remains on the network and an event is emitted about who should "pull it".\ \ It is an off-chain responsibility for the application to subscribe to their respective event stream (with proper identifier filtering) and normally retrieve only its assigned data (this change in some recovery scenario).\ \ Configuration of the end-points and health of the servers is managed through the DTP node, which in turn updates all its pipes and transport control objects.\ \ DTP will hide the high complexity of many race conditions (assignment to a server that died) and connection migrations among all end-points belonging to the same Node.</p> <h2 id=data-deletion>Data Deletion<a class=headerlink href=#data-deletion title="Permanent link">&para;</a></h2> <p>Once the data is confirmed consumed by the receiver(s), then it can be deleted on the L1 network to recover some storage fee &lt;\<revisit the design needed here once sui implements storage fund>&gt;.\ \ The sender of the data can opt-out from automated deletion and assume the full storage cost.\ \ Automated deletion is controlled by DTP to provide a fair time for the receiver(s) to consume the data and can be fine tuned through the sender service level agreement (SLA).\ \ The SLAs are publish by the server (in its Node object) and one is selected by the client at the time of the connection being established.</p> <h2 id=data-consumption-confirmation>Data Consumption Confirmation<a class=headerlink href=#data-consumption-confirmation title="Permanent link">&para;</a></h2> <p>TCP protocol includes acknowledgment of L4 delivery to the destination, but without guarantee of being consumed by the application (requires additional protocol at layer 7). \ \ DTP layer supports both; a confirmation of the data being available on the L1 network (TCP delivery equivalent) and optional confirmation of the client consuming the data (L7 protocol equivalent).\ \ Example of use would be to integrate in the dApps the verification that the data was persisted off-chain by the destination. There is no verification that the destination is honest, but this would be used in context where it would be in the destination best interest to act honestly.\ \ Another benefit for data confirmation is to shorten the time that the data need to be preserved on the network, therefore saving storage fee for the sender. \ \ The "consumed state" is controlled by the receiving application above DTP (the app call a function in the SDK to confirm consumption).\ \ In some use case, the sender may choose to stop transferring further data until the receiver confirm consuming some of the oldest data, therefore motivating the receiver to remain honest. All this will be done under the supervision of DTP for honest handling of the connection service level agreement (SLA).</p> <h2 id=public-broadcasting>Public Broadcasting<a class=headerlink href=#public-broadcasting title="Permanent link">&para;</a></h2> <p>Similar to unidirectional, but without encryption and using Broadcast objects instead of a Pipe and Transport control.</p> <figure><img src="../.gitbook/assets/broadcast (1).png" alt><figcaption><p>Broadcasting Specific Objects</p></figcaption></figure> <p>The broadcast control implements some related crypto-economic feature. Examples:</p> <ul> <li>A live broadcaster has to pay for the gas fee and storage, which is wasteful if there is no one listening... one option will be to let DTP stop the writing of the stream on the network until there are enough fund from enough listeners willing to cover, say, the cost of the next 1 minute. DTP handles the automatic "on air" logic and fairly spread the cost among the contributors.</li> <li>Listener may choose to tip and message a live talking broadcaster for a special request.</li> </ul> <p>There are some technical challenges particular to broadcasting (See <a href=../future-work/#broadcasting-challenges>Future Work</a>).\</p> <hr> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">January 10, 2023</span> </small> </div> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["content.code.annotate", "content.tooltips", "navigation.indexes", "navigation.instant", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.e5c33ebb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../../assets/javascripts/bundle.ba449ae6.min.js></script> </body> </html>